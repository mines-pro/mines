<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mines Game</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CSS VARIABLES & RESET
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --gold:          #f0c040;
  --gold-dim:      #c89a28;
  --neon-cyan:     #22d3ee;
  --neon-emerald:  #34d399;
  --neon-amber:    #fbbf24;
  --neon-rose:     #fb7185;
  --neon-blue:     #60a5fa;
  --bg-deep:       #0a0c14;
  --glass-bg:      rgba(18, 22, 40, 0.65);
  --glass-border:  rgba(255,255,255,0.11);
  --glass-border2: rgba(255,255,255,0.22);
  --text-primary:  #f0f0f5;
  --text-muted:    #9aa0b8;
  --radius:        16px;
  --radius-sm:     10px;
  --blur-main:     24px;
  --blur-modal:    30px;
  --blur-tile:     6px;
}
* { margin:0; padding:0; box-sizing:border-box; }
html, body {
  height:100%; min-height:100vh;
  font-family:'Rajdhani', sans-serif;
  background: var(--bg-deep);
  color: var(--text-primary);
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CANVAS BG
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#bgCanvas {
  position:fixed; top:0; left:0;
  width:100%; height:100%;
  z-index:0; pointer-events:none;
}

/* noise grain */
body::before {
  content:'';
  position:fixed; inset:0; z-index:1;
  pointer-events:none; opacity:.04;
  background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  background-size:200px 200px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGE LAYOUT
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.page-wrap {
  position:relative; z-index:2;
  min-height:100vh;
  display:flex; justify-content:center;
  align-items:flex-start;
  padding:28px 16px 48px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GLASS CONTAINER
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.container {
  background: var(--glass-bg);
  backdrop-filter: blur(var(--blur-main)) saturate(1.4);
  -webkit-backdrop-filter: blur(var(--blur-main)) saturate(1.4);
  border: 1.5px solid var(--glass-border);
  border-radius: var(--radius);
  box-shadow: 0 8px 40px rgba(0,0,0,.52),
              inset 0 1px 0 rgba(255,255,255,.07);
  max-width:480px; width:100%;
  padding:28px 22px 32px;
  margin-top:20px;
}
.hidden { display:none !important; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TITLE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.title {
  font-family:'Orbitron', sans-serif;
  font-size:50px; font-weight:900;
  letter-spacing:13px; text-align:center;
  margin-bottom:4px;
  background: linear-gradient(135deg, #f0c040 0%, #fbbf24 45%, #f59e0b 75%, #f0c040 100%);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  filter: drop-shadow(0 0 20px rgba(240,192,64,.42));
  text-transform:uppercase;
}
.subtitle {
  font-size:14px; color:var(--text-muted);
  text-align:center; margin-bottom:24px;
  letter-spacing:2px; direction:rtl; font-weight:500;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   USER INFO
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.user-info {
  background: rgba(12,15,26,0.68);
  backdrop-filter: blur(10px);
  border: 1.5px solid var(--glass-border);
  border-radius: var(--radius-sm);
  padding:12px 16px; margin-bottom:14px;
  display:flex; justify-content:space-between;
  align-items:center; gap:10px;
}
.user-name {
  font-family:'Orbitron', sans-serif;
  font-size:13px; font-weight:700;
  color:var(--gold); letter-spacing:1px; margin-bottom:2px;
  text-shadow: 0 0 8px rgba(240,192,64,.25);
}
.user-phone { font-size:13px; color:var(--text-muted); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INPUTS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
input {
  width:100%; padding:14px 16px; margin:8px 0;
  background: rgba(12,15,26,0.78);
  border: 1.5px solid var(--glass-border2);
  border-radius: var(--radius-sm);
  font-family:'Rajdhani', sans-serif;
  font-size:16px; font-weight:500;
  color:var(--text-primary); outline:none;
  transition: border-color .25s, box-shadow .25s;
}
input::placeholder { color:var(--text-muted); }
input:focus {
  border-color: var(--neon-cyan);
  box-shadow: 0 0 14px rgba(34,211,238,.25);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BUTTONS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
button {
  width:100%; padding:15px 18px; margin:7px 0;
  border-radius: var(--radius-sm);
  font-family:'Rajdhani', sans-serif;
  font-size:17px; font-weight:700;
  letter-spacing:1.2px; cursor:pointer;
  border:none; position:relative; overflow:hidden;
  transition: transform .18s, box-shadow .25s, background .22s;
  text-transform:uppercase;
}
button:hover:not(:disabled) { transform:translateY(-2px); }
button:active:not(:disabled) { transform:translateY(0); }
button:disabled { opacity:.38; cursor:not-allowed; }

.btn-green {
  background: rgba(52,211,153,.18);
  border: 1.5px solid rgba(52,211,153,.55);
  color: var(--neon-emerald);
  box-shadow: 0 0 12px rgba(52,211,153,.18), inset 0 1px 0 rgba(52,211,153,.14);
}
.btn-green:hover:not(:disabled) {
  box-shadow: 0 0 24px rgba(52,211,153,.4);
  background: rgba(52,211,153,.26);
}
.btn-green:active:not(:disabled) { background: rgba(52,211,153,.34); }

.btn-orange {
  background: rgba(251,191,36,.15);
  border: 1.5px solid rgba(251,191,36,.5);
  color: var(--neon-amber);
  box-shadow: 0 0 12px rgba(251,191,36,.15);
}
.btn-orange:hover:not(:disabled) {
  box-shadow: 0 0 24px rgba(251,191,36,.35);
  background: rgba(251,191,36,.24);
}
.btn-orange:active:not(:disabled) { background: rgba(251,191,36,.32); }

.btn-blue {
  background: rgba(96,165,250,.17);
  border: 1.5px solid rgba(96,165,250,.5);
  color: var(--neon-blue);
  box-shadow: 0 0 12px rgba(96,165,250,.15);
}
.btn-blue:hover:not(:disabled) {
  box-shadow: 0 0 24px rgba(96,165,250,.35);
  background: rgba(96,165,250,.26);
}
.btn-blue:active:not(:disabled) { background: rgba(96,165,250,.34); }

.btn-red {
  background: rgba(251,113,133,.15);
  border: 1.5px solid rgba(251,113,133,.5);
  color: var(--neon-rose);
  box-shadow: 0 0 12px rgba(251,113,133,.15);
}
.btn-red:hover:not(:disabled) {
  box-shadow: 0 0 24px rgba(251,113,133,.35);
  background: rgba(251,113,133,.26);
}
.btn-red:active:not(:disabled) { background: rgba(251,113,133,.34); }

.btn-gold {
  background: linear-gradient(135deg, rgba(240,192,64,.27), rgba(251,191,36,.2));
  border: 1.5px solid rgba(240,192,64,.55);
  color: var(--gold);
  box-shadow: 0 0 14px rgba(240,192,64,.22);
}
.btn-gold:hover:not(:disabled) {
  box-shadow: 0 0 28px rgba(240,192,64,.44);
  background: linear-gradient(135deg, rgba(240,192,64,.36), rgba(251,191,36,.28));
}
.btn-gold:active:not(:disabled) {
  background: linear-gradient(135deg, rgba(240,192,64,.44), rgba(251,191,36,.36));
}

.btn-reset {
  background: rgba(96,165,250,.15);
  border: 1.5px solid rgba(96,165,250,.45);
  color: var(--neon-blue);
  box-shadow: 0 0 12px rgba(96,165,250,.13);
}
.btn-reset:hover:not(:disabled) {
  box-shadow: 0 0 24px rgba(96,165,250,.33);
  background: rgba(96,165,250,.24);
}
.btn-reset:active:not(:disabled) { background: rgba(96,165,250,.32); }

.logout-btn {
  width:auto; padding:9px 18px; margin:0;
  background: rgba(251,113,133,.14);
  border: 1.5px solid rgba(251,113,133,.45);
  color: var(--neon-rose);
  border-radius: var(--radius-sm);
  font-family:'Rajdhani', sans-serif;
  font-size:14px; font-weight:600;
  letter-spacing:1px; cursor:pointer;
  transition: background .2s, box-shadow .2s;
  text-transform:uppercase;
}
.logout-btn:hover {
  background: rgba(251,113,133,.24);
  box-shadow: 0 0 18px rgba(251,113,133,.3);
}
.logout-btn:active { background: rgba(251,113,133,.32); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BALANCE BAR
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.balance-section {
  display:flex; justify-content:space-around; gap:12px;
  background: rgba(8,10,18,0.65);
  backdrop-filter: blur(12px);
  border: 1.5px solid var(--glass-border);
  border-radius: var(--radius);
  padding:16px 12px; margin:16px 0;
}
.balance-item { text-align:center; flex:1; }
.balance-label {
  font-size:11px; color:var(--text-muted);
  letter-spacing:2.5px; text-transform:uppercase; margin-bottom:5px;
}
.balance-value {
  font-family:'Orbitron', sans-serif;
  font-size:22px; font-weight:700;
  color:var(--gold);
  text-shadow: 0 0 10px rgba(240,192,64,.45);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   5Ã—5 GAME GRID
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.grid {
  display:grid;
  grid-template-columns: repeat(5,1fr);
  gap:7px; margin:18px 0;
}
.tile {
  aspect-ratio:1;
  background: linear-gradient(150deg, rgba(28,34,56,0.82), rgba(18,22,40,0.94));
  backdrop-filter: blur(var(--blur-tile));
  border: 1.5px solid var(--glass-border2);
  border-radius:13px;
  display:flex; align-items:center; justify-content:center;
  font-size:26px; cursor:pointer;
  transition: transform .22s cubic-bezier(.34,1.56,.64,1),
              box-shadow .28s, background .25s, border-color .25s;
  position:relative; overflow:hidden; user-select:none;
}
.tile::before {
  content:'';
  position:absolute; top:0; left:8%; right:8%; height:1px;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.2), transparent);
  pointer-events:none;
}
.tile:hover:not(.revealed) {
  transform: scale(1.09);
  border-color: rgba(34,211,238,.6);
  box-shadow: 0 0 22px rgba(34,211,238,.32),
              inset 0 0 14px rgba(34,211,238,.08);
  background: linear-gradient(150deg, rgba(30,55,88,0.78), rgba(18,28,52,0.9));
}
.tile.revealed { cursor:default; }

.tile.safe {
  background: linear-gradient(150deg, rgba(240,192,64,.32), rgba(251,191,36,.16));
  border-color: rgba(240,192,64,.65);
  box-shadow: 0 0 18px rgba(240,192,64,.36),
              inset 0 0 10px rgba(240,192,64,.1);
  animation: tileIn .28s cubic-bezier(.34,1.56,.64,1);
}
.tile.mine {
  background: linear-gradient(150deg, rgba(251,113,133,.34), rgba(220,20,60,.18));
  border-color: rgba(251,113,133,.7);
  box-shadow: 0 0 20px rgba(251,60,80,.42),
              inset 0 0 12px rgba(251,60,80,.12);
  animation: tileIn .28s cubic-bezier(.34,1.56,.64,1);
}
.tile.mine-hit {
  animation: mineFlash .5s ease-out forwards;
}

@keyframes tileIn {
  0%   { transform:scale(.85); opacity:.6; }
  100% { transform:scale(1);   opacity:1;  }
}
@keyframes mineFlash {
  0%   { box-shadow: 0 0 52px rgba(251,60,80,1); transform:scale(1.12); }
  60%  { box-shadow: 0 0 28px rgba(251,60,80,.6); transform:scale(1);   }
  100% { box-shadow: 0 0 20px rgba(251,60,80,.42); transform:scale(1);  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MESSAGES
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.msg {
  padding:12px 16px; margin:12px 0;
  border-radius: var(--radius-sm);
  text-align:center; font-weight:600;
  font-size:15px; display:none;
  letter-spacing:.5px;
  backdrop-filter: blur(8px);
}
.msg.success {
  background: rgba(52,211,153,.16);
  border: 1.5px solid rgba(52,211,153,.45);
  color: var(--neon-emerald);
  text-shadow: 0 0 6px rgba(52,211,153,.3);
}
.msg.error {
  background: rgba(251,113,133,.16);
  border: 1.5px solid rgba(251,113,133,.45);
  color: var(--neon-rose);
  text-shadow: 0 0 6px rgba(251,113,133,.3);
}
.timer-msg {
  background: rgba(251,191,36,.14);
  border: 1.5px solid rgba(251,191,36,.4);
  color: var(--neon-amber);
  padding:10px 14px; border-radius: var(--radius-sm);
  margin:8px 0; text-align:center;
  font-size:14px; font-weight:500;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INFO BOX
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.info-box {
  background: rgba(240,192,64,.08);
  border: 1.5px solid rgba(240,192,64,.28);
  padding:18px; border-radius: var(--radius);
  margin:16px 0; text-align:center;
}
.info-title {
  color:var(--gold); font-size:14px; font-weight:600;
  margin-bottom:14px; direction:rtl; letter-spacing:.5px;
  text-shadow: 0 0 6px rgba(240,192,64,.25);
}

.pay-label {
  display:inline-flex; align-items:center; gap:7px;
  margin-bottom:6px; margin-top:10px;
}
.pay-label .badge {
  font-family:'Orbitron', sans-serif;
  font-size:10px; font-weight:700;
  letter-spacing:1.5px; text-transform:uppercase;
  padding:4px 10px; border-radius:20px;
}
.pay-label .badge.jazz {
  background: rgba(52,211,153,.16);
  border: 1px solid rgba(52,211,153,.5);
  color: var(--neon-emerald);
  box-shadow: 0 0 8px rgba(52,211,153,.18);
}
.pay-label .badge.easy {
  background: rgba(251,191,36,.14);
  border: 1px solid rgba(251,191,36,.48);
  color: var(--neon-amber);
  box-shadow: 0 0 8px rgba(251,191,36,.18);
}

.pay-number {
  font-family:'Orbitron', sans-serif;
  font-size:20px; font-weight:700;
  color:var(--text-primary);
  background: rgba(8,10,18,0.65);
  border: 1.5px solid rgba(255,255,255,.13);
  padding:11px 14px; border-radius: var(--radius-sm);
  margin:0 0 4px; letter-spacing:2px;
  text-align:center;
  text-shadow: 0 0 8px rgba(255,255,255,.15);
}
.pay-number.jazz-num { border-color: rgba(52,211,153,.3); }
.pay-number.easy-num { border-color: rgba(251,191,36,.3); }

/* Payment App Buttons */
.payment-app-btn {
  width:100%; padding:16px 20px; margin:8px 0;
  border-radius: var(--radius-sm);
  font-family:'Rajdhani', sans-serif;
  cursor:pointer; border:none;
  transition: all 0.3s ease;
  position:relative; overflow:hidden;
}
.payment-app-btn:active { transform: scale(0.98); }

.jazzcash-btn {
  background: linear-gradient(135deg, rgba(220,38,38,0.2), rgba(239,68,68,0.15));
  border: 2px solid rgba(220,38,38,0.5);
  box-shadow: 0 0 20px rgba(220,38,38,0.2);
}
.jazzcash-btn:hover {
  background: linear-gradient(135deg, rgba(220,38,38,0.3), rgba(239,68,68,0.25));
  box-shadow: 0 0 30px rgba(220,38,38,0.4);
}

.easypaisa-btn {
  background: linear-gradient(135deg, rgba(34,197,94,0.2), rgba(52,211,153,0.15));
  border: 2px solid rgba(34,197,94,0.5);
  box-shadow: 0 0 20px rgba(34,197,94,0.2);
}
.easypaisa-btn:hover {
  background: linear-gradient(135deg, rgba(34,197,94,0.3), rgba(52,211,153,0.25));
  box-shadow: 0 0 30px rgba(34,197,94,0.4);
}

.app-btn-content {
  display:flex; align-items:center; gap:16px;
  justify-content:center;
}
.app-icon {
  font-size:32px;
  filter: drop-shadow(0 0 8px rgba(255,255,255,0.3));
}
.app-details {
  text-align:left;
}
.app-name {
  font-size:20px; font-weight:700;
  color:var(--text-primary); letter-spacing:1px;
  margin-bottom:2px;
  font-family:'Orbitron', sans-serif;
}
.app-hint {
  font-size:12px; color:var(--text-muted);
  letter-spacing:0.5px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   WITHDRAW TOGGLE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.withdraw-toggle {
  display:flex; gap:0; margin:14px 0 10px;
  background: rgba(8,10,18,0.6);
  border: 1.5px solid var(--glass-border);
  border-radius: var(--radius-sm);
  overflow:hidden;
}
.withdraw-toggle button {
  flex:1; margin:0; border-radius:0;
  padding:12px 8px; font-size:15px;
  background: transparent;
  border: none;
  box-shadow: none;
  color: var(--text-muted);
  transition: background .22s, color .22s, box-shadow .22s;
  text-transform:uppercase;
  letter-spacing:1px;
}
.withdraw-toggle button:hover:not(:disabled) { transform:none; }
.withdraw-toggle button.active-tab {
  background: rgba(52,211,153,.18);
  color: var(--neon-emerald);
  box-shadow: inset 0 0 12px rgba(52,211,153,.1);
}
.withdraw-toggle button.active-tab.easy-active {
  background: rgba(251,191,36,.16);
  color: var(--neon-amber);
  box-shadow: inset 0 0 12px rgba(251,191,36,.1);
}
.withdraw-toggle button + button {
  border-left: 1px solid var(--glass-border);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MODALS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.modal {
  display:none; position:fixed; inset:0;
  background: rgba(4,5,10,0.74);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index:1000;
  justify-content:center; align-items:center;
  padding:20px;
}
.modal.active { display:flex; }

.modal-content {
  background: rgba(14,17,30,0.82);
  backdrop-filter: blur(var(--blur-modal)) saturate(1.35);
  -webkit-backdrop-filter: blur(var(--blur-modal)) saturate(1.35);
  border: 1.5px solid var(--glass-border2);
  box-shadow: 0 14px 52px rgba(0,0,0,.58),
              inset 0 1px 0 rgba(255,255,255,.08);
  padding:28px 24px;
  border-radius: var(--radius);
  max-width:420px; width:100%;
  max-height:90vh; overflow-y:auto;
}
.modal-title {
  font-family:'Orbitron', sans-serif;
  font-size:19px; font-weight:700;
  color:var(--gold); margin-bottom:18px;
  text-align:center; letter-spacing:2px;
  text-shadow: 0 0 12px rgba(240,192,64,.35);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   KICKED OVERLAY
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.kicked-overlay {
  display:none; position:fixed; inset:0;
  background: rgba(3,4,8,0.95);
  backdrop-filter: blur(14px);
  z-index:9999;
  justify-content:center; align-items:center;
}
.kicked-overlay.active { display:flex; }

.kicked-box {
  background: rgba(14,17,30,0.9);
  backdrop-filter: blur(22px);
  border: 1.5px solid rgba(251,113,133,.35);
  box-shadow: 0 0 44px rgba(251,113,133,.18),
              0 14px 52px rgba(0,0,0,.58);
  padding:46px 36px; border-radius: var(--radius);
  text-align:center; max-width:360px; width:90%;
}
.kicked-box h2 {
  font-family:'Orbitron', sans-serif;
  color:var(--neon-rose); font-size:22px;
  margin-bottom:14px; letter-spacing:2px;
  text-shadow: 0 0 14px rgba(251,113,133,.5);
}
.kicked-box p {
  color:var(--text-muted); margin-bottom:22px;
  font-size:15px; line-height:1.55;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BUTTON ROW
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.btn-row { display:flex; gap:8px; }
.btn-row button { flex:1; margin:7px 0; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCROLLBAR
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
::-webkit-scrollbar       { width:6px; }
::-webkit-scrollbar-track { background:transparent; }
::-webkit-scrollbar-thumb { background:rgba(255,255,255,.14); border-radius:3px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media(max-width:420px){
  .container      { padding:20px 14px 26px; }
  .title          { font-size:36px; letter-spacing:7px; }
  .balance-value  { font-size:18px; }
  .tile           { font-size:22px; }
  .modal-content  { padding:22px 16px; }
  .pay-number     { font-size:17px; }
}
</style>
</head>
<body>

<!-- â•â•â• PARTICLE CANVAS â•â•â• -->
<canvas id="bgCanvas"></canvas>

<div class="page-wrap">

<!-- â•â•â• KICKED OVERLAY â•â•â• -->
<div id="kickedOverlay" class="kicked-overlay">
  <div class="kicked-box">
    <div style="font-size:50px; margin-bottom:12px;">ğŸš«</div>
    <h2>SESSION TERMINATED</h2>
  </div>
</div>

<!-- â•â•â• LOGIN SCREEN â•â•â• -->
<div id="loginScreen" class="container">
  <div class="title">MINES</div>
  <div class="subtitle">Ø§Ù¾Ù†Ø§ Ù†Ø§Ù… Ø§ÙˆØ± Ù†Ù…Ø¨Ø± Ù„Ú©Ú¾ÛŒÚº</div>
  <div id="loginMsg" class="msg"></div>
  <input type="text"  id="loginName"  placeholder="Your Name"   maxlength="50">
  <input type="tel"   id="loginPhone" placeholder="03XXXXXXXXX" maxlength="11">
  <button class="btn-green" onclick="handleLogin()">LOGIN / Ù„Ø§Ú¯ Ø§Ù†</button>
</div>

<!-- â•â•â• GAME SCREEN â•â•â• -->
<div id="gameScreen" class="container hidden">
  <div class="user-info">
    <div>
      <div class="user-name"  id="displayName"></div>
      <div class="user-phone" id="displayPhone"></div>
    </div>
    <button class="logout-btn" onclick="handleLogout()">Logout</button>
  </div>

  <div class="title">MINES</div>
  <div id="gameMsg" class="msg"></div>
  <div id="cooldownMsg" class="timer-msg" style="display:none;"></div>

  <div class="btn-row">
    <button class="btn-green" id="depositBtn" onclick="openDepositModal()">DEPOSIT</button>
    <button class="btn-orange" id="withdrawBtn" onclick="openWithdrawModal()">WITHDRAW</button>
  </div>

  <div class="balance-section">
    <div class="balance-item">
      <div class="balance-label">Balance</div>
      <div class="balance-value">Rs <span id="balance">0</span></div>
    </div>
    <div class="balance-item">
      <div class="balance-label">Current Win</div>
      <div class="balance-value">Rs <span id="win">0</span></div>
    </div>
  </div>

  <div class="grid" id="gameGrid"></div>

  <button class="btn-blue"  onclick="openBetModal()">Bet Rs <span id="betDisplay">0</span></button>
  <button class="btn-red"   onclick="openMinesModal()">ğŸ’£ Mines: <span id="minesDisplay">3</span></button>
  <button class="btn-gold"  id="cashoutBtn" onclick="cashout()" disabled>Cash Out</button>
  <button class="btn-reset" onclick="resetGame()">ğŸ”„ Reset</button>
</div>

</div><!-- /page-wrap -->

<!-- â•â•â• DEPOSIT MODAL â•â•â• -->
<div id="depositModal" class="modal">
  <div class="modal-content">
    <div class="modal-title">Deposit Request</div>
    
    <!-- Step 1: Enter Amount -->
    <div id="depositStep1">
      <div class="info-box">
        <div class="info-title">Ø±Ù‚Ù… Ù„Ú©Ú¾ÛŒÚº</div>
      </div>
      <input type="number" id="depositAmount" placeholder="Amount (Minimum Rs 500)" min="500" oninput="checkDepositAmount()">
      <div id="depositCooldown" style="display:none;" class="timer-msg"></div>
      <button class="btn-blue" id="depositNextBtn" onclick="showPaymentMethods()" disabled style="opacity:0.5;">Next - Payment Method</button>
      <button class="btn-red" onclick="closeModal('depositModal')">Cancel</button>
    </div>
    
    <!-- Step 2: Select Payment Method -->
    <div id="depositStep2" style="display:none;">
      <div class="info-box">
        <div class="info-title">Payment Method Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº</div>
        <div style="text-align:center; margin:12px 0;">
          <div style="font-size:22px; font-weight:700; color:var(--gold);">
            Rs <span id="depositAmountDisplay">0</span>
          </div>
          <div style="font-size:13px; color:var(--text-muted); margin-top:4px;">
            Amount to send
          </div>
        </div>
      </div>
      
      <!-- JazzCash Button -->
      <button class="payment-app-btn jazzcash-btn" onclick="openJazzCashApp()">
        <div class="app-btn-content">
          <span class="app-icon">ğŸ“±</span>
          <div class="app-details">
            <div class="app-name">JazzCash</div>
            <div class="app-hint">Tap to open app</div>
          </div>
        </div>
      </button>
      
      <!-- Easypaisa Button -->
      <button class="payment-app-btn easypaisa-btn" onclick="openEasypaisaApp()">
        <div class="app-btn-content">
          <span class="app-icon">ğŸ“±</span>
          <div class="app-details">
            <div class="app-name">Easypaisa</div>
            <div class="app-hint">Tap to open app</div>
          </div>
        </div>
      </button>
      
      <div style="font-size:12px; color:var(--gold); text-align:center; margin:12px 0; direction:rtl;">
        âš ï¸ Ø§ÛŒÙ¾ Ø³Û’ Ø±Ù‚Ù… Ø¨Ú¾ÛŒØ¬Ù†Û’ Ú©Û’ Ø¨Ø¹Ø¯ Ù†ÛŒÚ†Û’ Submit Ø¯Ø¨Ø§Ø¦ÛŒÚº
      </div>
      
      <button class="btn-green" id="depositSubmitBtn" onclick="submitDeposit()">âœ… I Sent Money - Submit Request</button>
      <button class="btn-red" onclick="backToAmountStep()">â† Back</button>
    </div>
  </div>
</div>


<!-- â•â•â• WITHDRAW MODAL â•â•â• -->
<div id="withdrawModal" class="modal">
  <div class="modal-content">
    <div class="modal-title">Withdraw Request</div>
    <div class="withdraw-toggle">
      <button id="tabJazz"  class="active-tab"  onclick="switchWithdrawTab('jazz')">JazzCash</button>
      <button id="tabEasy"  onclick="switchWithdrawTab('easy')">Easypaisa</button>
    </div>
    <input type="tel" id="withdrawJazz" placeholder="JazzCash 03XXXXXXXXX" maxlength="11">
    <input type="number" id="withdrawAmount" placeholder="Amount (Minimum Rs 1000)" min="1000">
    <div id="withdrawCooldown" style="display:none;" class="timer-msg"></div>
    <button class="btn-orange" onclick="submitWithdraw()">Submit Request</button>
    <button class="btn-red"    onclick="closeModal('withdrawModal')">Cancel</button>
  </div>
</div>

<!-- â•â•â• BET MODAL â•â•â• -->
<div id="betModal" class="modal">
  <div class="modal-content">
    <div class="modal-title">Set Bet Amount</div>
    <input type="number" id="betInput" placeholder="Amount (Rs 100 â€“ 10,000)" min="100" max="10000">
    <button class="btn-blue" onclick="setBet()">Set Bet</button>
    <button class="btn-red"  onclick="closeModal('betModal')">Cancel</button>
  </div>
</div>

<!-- â•â•â• MINES MODAL â•â•â• -->
<div id="minesModal" class="modal">
  <div class="modal-content">
    <div class="modal-title">ğŸ’£ Set Mines Count</div>
    <input type="number" id="minesInput" placeholder="Mines (1â€“24)" min="1" max="24" value="3">
    <button class="btn-red"  onclick="setMines()">Set Mines</button>
    <button class="btn-blue" onclick="closeModal('minesModal')">Cancel</button>
  </div>
</div>

<!-- â•â•â• PENDING DEPOSIT STATUS MODAL â•â•â• -->
<div id="pendingDepositModal" class="modal">
  <div class="modal-content">
    <div class="modal-title">â³ Deposit Request Pending</div>
    <div class="info-box" style="background:rgba(52,211,153,0.08);">
      <div style="text-align:center; margin-bottom:16px;">
        <div style="font-size:14px; color:var(--text-muted); margin-bottom:8px;">Amount</div>
        <div style="font-size:28px; font-weight:700; color:var(--neon-emerald);" id="pendingDepAmount">Rs 0</div>
      </div>
      <div style="font-size:13px; color:var(--text-muted); text-align:center; margin-bottom:12px;" id="pendingDepDate">
        Submitted: --
      </div>
      <div style="font-size:14px; color:var(--gold); text-align:center; direction:rtl;">
        Admin Ø¬Ù„Ø¯ Ù…Ù†Ø¸ÙˆØ± Ú©Ø±ÛŒÚº Ú¯Û’
      </div>
    </div>
    <button class="btn-blue" onclick="closeModal('pendingDepositModal')">OK</button>
  </div>
</div>

<!-- â•â•â• PENDING WITHDRAW STATUS MODAL â•â•â• -->
<div id="pendingWithdrawModal" class="modal">
  <div class="modal-content">
    <div class="modal-title">â³ Withdraw Request Pending</div>
    <div class="info-box" style="background:rgba(251,191,36,0.08);">
      <div style="text-align:center; margin-bottom:16px;">
        <div style="font-size:14px; color:var(--text-muted); margin-bottom:8px;">Amount</div>
        <div style="font-size:28px; font-weight:700; color:var(--neon-amber);" id="pendingWdAmount">Rs 0</div>
      </div>
      <div style="font-size:13px; color:var(--text-muted); margin-bottom:4px;">
        <span style="color:var(--text-primary);">Method:</span> <span id="pendingWdMethod">--</span>
      </div>
      <div style="font-size:13px; color:var(--text-muted); margin-bottom:12px;">
        <span style="color:var(--text-primary);">Number:</span> <span id="pendingWdNumber">--</span>
      </div>
      <div style="font-size:13px; color:var(--text-muted); text-align:center; margin-bottom:12px;" id="pendingWdDate">
        Submitted: --
      </div>
      <div style="font-size:14px; color:var(--gold); text-align:center; direction:rtl;">
        Admin Ø¬Ù„Ø¯ process Ú©Ø±ÛŒÚº Ú¯Û’
      </div>
    </div>
    <button class="btn-blue" onclick="closeModal('pendingWithdrawModal')">OK</button>
  </div>
</div>

<!-- â•â•â• ADAPTIVE PERFORMANCE â•â•â• -->
<script>
(function(){
  const cores  = navigator.hardwareConcurrency || 4;
  const dpr    = window.devicePixelRatio || 1;
  const w      = screen.width;
  const isLow  = cores <= 2 || (dpr >= 3 && w < 400) || (w < 320);
  window._perfTier = isLow ? 'low' : 'high';
  if(isLow){
    document.documentElement.style.setProperty('--blur-main',  '14px');
    document.documentElement.style.setProperty('--blur-modal', '18px');
    document.documentElement.style.setProperty('--blur-tile',  '3px');
  }
})();
</script>

<!-- â•â•â• BACKGROUND PARTICLE ENGINE â•â•â• -->
<script>
(function(){
  const canvas = document.getElementById('bgCanvas');
  const ctx    = canvas.getContext('2d');
  let W, H;
  function resize(){
    W = canvas.width  = window.innerWidth;
    H = canvas.height = window.innerHeight;
  }
  window.addEventListener('resize', resize);
  resize();

  const isLow       = window._perfTier === 'low';
  const PART_COUNT  = isLow ? 55  : 120;
  const SHARD_COUNT = isLow ? 8   : 20;

  const PALETTE = [
    [34,211,238],[96,165,250],[52,211,153],
    [240,192,64],[251,191,36],[180,195,240],
  ];

  class Particle {
    constructor(){ this.reset(true); }
    reset(init){
      this.x  = init ? Math.random()*W : (Math.random()<.5 ? -12 : W+12);
      this.y  = init ? Math.random()*H : Math.random()*H;
      this.r  = .5 + Math.random()*2.4;
      this.vx = (Math.random()-.5)*.38;
      this.vy = (Math.random()-.5)*.38;
      this.col   = PALETTE[Math.floor(Math.random()*PALETTE.length)];
      this.alpha = .12 + Math.random()*.5;
      this.phase = Math.random()*Math.PI*2;
      this.freq  = .35 + Math.random()*.55;
    }
    update(){
      this.x+=this.vx; this.y+=this.vy; this.phase+=this.freq*.016;
      if(this.x<-30||this.x>W+30||this.y<-30||this.y>H+30) this.reset(false);
    }
    draw(){
      const a = this.alpha + Math.sin(this.phase)*.13;
      const [r,g,b] = this.col;
      ctx.beginPath(); ctx.arc(this.x, this.y, this.r, 0, Math.PI*2);
      ctx.fillStyle = `rgba(${r},${g},${b},${a})`; ctx.fill();
      if(!isLow){
        ctx.beginPath(); ctx.arc(this.x, this.y, this.r*3.5, 0, Math.PI*2);
        ctx.fillStyle = `rgba(${r},${g},${b},${a*.16})`; ctx.fill();
      }
    }
  }

  class Shard {
    constructor(){ this.reset(true); }
    reset(init){
      this.x     = init ? Math.random()*W : -70;
      this.y     = init ? Math.random()*H : Math.random()*H;
      this.w     = 2.5 + Math.random()*4;
      this.h     = 28 + Math.random()*75;
      this.angle = -.52 + Math.random()*.25;
      this.speed = .28 + Math.random()*.32;
      this.alpha = .028 + Math.random()*.065;
      this.col   = [195+Math.random()*60, 210+Math.random()*45, 255];
    }
    update(){ this.x += this.speed; if(this.x > W+100) this.reset(false); }
    draw(){
      ctx.save();
      ctx.translate(this.x, this.y);
      ctx.rotate(this.angle);
      const g = ctx.createLinearGradient(0,0,0,this.h);
      const [r,gr,b] = this.col;
      g.addColorStop(0,   `rgba(${r},${gr},${b},0)`);
      g.addColorStop(.28, `rgba(${r},${gr},${b},${this.alpha})`);
      g.addColorStop(.72, `rgba(${r},${gr},${b},${this.alpha})`);
      g.addColorStop(1,   `rgba(${r},${gr},${b},0)`);
      ctx.fillStyle = g;
      ctx.fillRect(-this.w*.5, 0, this.w, this.h);
      ctx.restore();
    }
  }

  const particles = [], shards = [];
  for(let i=0; i<PART_COUNT;  i++) particles.push(new Particle());
  for(let i=0; i<SHARD_COUNT; i++) shards.push(new Shard());

  function drawBg(){
    const g = ctx.createLinearGradient(0,0, W*.55, H);
    g.addColorStop(0,   '#0a0c14');
    g.addColorStop(.4,  '#0e1320');
    g.addColorStop(.72, '#111a2e');
    g.addColorStop(1,   '#0c1118');
    ctx.fillStyle = g;
    ctx.fillRect(0,0,W,H);
    if(!isLow){
      [
        { x:W*.12, y:H*.28, r:W*.24, c:'rgba(34,211,238,.032)' },
        { x:W*.82, y:H*.68, r:W*.21, c:'rgba(96,165,250,.028)' },
        { x:W*.48, y:H*.88, r:W*.19, c:'rgba(52,211,153,.022)' },
        { x:W*.72, y:H*.12, r:W*.17, c:'rgba(240,192,64,.020)' },
        { x:W*.25, y:H*.75, r:W*.15, c:'rgba(251,191,36,.018)' },
      ].forEach(b=>{
        const rg = ctx.createRadialGradient(b.x,b.y,0, b.x,b.y,b.r);
        rg.addColorStop(0, b.c);
        rg.addColorStop(1, 'transparent');
        ctx.fillStyle = rg;
        ctx.fillRect(0,0,W,H);
      });
    }
  }

  function loop(){
    drawBg();
    shards.forEach(s=>{ s.update(); s.draw(); });
    particles.forEach(p=>{ p.update(); p.draw(); });
    requestAnimationFrame(loop);
  }
  loop();
})();
</script>

<!-- â•â•â• FIREBASE MODULE â•â•â• -->
<script type="module">
import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
import { getDatabase, ref, set, get, update, onValue, push, serverTimestamp }
  from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

const firebaseConfig = {
  apiKey:"AIzaSyA8C1-TpsRo0UsATshlI8Dy0v40PnLRlc4",
  authDomain:"mines-67d8c.firebaseapp.com",
  databaseURL:"https://mines-67d8c-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId:"mines-67d8c",
  storageBucket:"mines-67d8c.firebasestorage.app",
  messagingSenderId:"918317634273",
  appId:"1:918317634273:web:8527c0d58a1f3de0371da0",
  measurementId:"G-NHC6K1X3KZ"
};

const app      = initializeApp(firebaseConfig);
const database = getDatabase(app);

window.db               = database;
window.dbRef            = ref;
window.dbSet            = set;
window.dbGet            = get;
window.dbUpdate         = update;
window.dbOnValue        = onValue;
window.dbPush           = push;
window.dbServerTimestamp = serverTimestamp;

if (window._fbResolve) window._fbResolve();
console.log('âœ… Firebase initialized successfully!');
</script>

<!-- â•â•â• MAIN GAME SCRIPT â•â•â• -->
<script>
window._fbReady = new Promise(r => { window._fbResolve = r; });
async function fbReady(){ await window._fbReady; }

/* â”€â”€â”€ Device fingerprint â”€â”€â”€ */
function getDeviceFingerprint(){
  const n=navigator, s=window.screen;
  return btoa(`${n.userAgent}_${s.width}x${s.height}_${s.colorDepth}_${n.language}`).substring(0,32);
}

/* â”€â”€â”€ Game State â”€â”€â”€ */
let gameState = {
  userId:null, userName:'', userPhone:'',
  balance:0, currentBet:0, currentWin:0,
  minesCount:3, gameActive:false,
  minePositions:[], revealedTiles:[],
  betSet:false, tilesClicked:false
};

/* â”€â”€â”€ Sound Effects â”€â”€â”€ */
const sounds = {
  click: new Audio('data:audio/wav;base64,UklGRhIAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YU4AAAB/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/'),
  success: new Audio('data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YWAAAAB/gH+Af4B/gH+Af4B/gH+Af4B/gH+Af4B/gH+Af4B/gH+Af4B/gH+Af4B/gH+Af4B/'),
  error: new Audio('data:audio/wav;base64,UklGRh4AAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YVoAAACAf39/gICAf39/gIB/f39/f4CAf39/gH+Af4B/gH+Af39/f3+Af4B/gH+Af39/'),
  win: new Audio('data:audio/wav;base64,UklGRjIAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YW4AAAB/gICAgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpI='),
  mine: new Audio('data:audio/wav;base64,UklGRiYAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YWIAAACAfn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+')
};

// Preload sounds
Object.values(sounds).forEach(sound => {
  sound.volume = 0.3;
  sound.load();
});

function playSound(soundName){
  try {
    if(sounds[soundName]){
      sounds[soundName].currentTime = 0;
      sounds[soundName].play().catch(e => console.log('Sound blocked:', e));
    }
  } catch(e) {
    console.log('Sound error:', e);
  }
}

/* â”€â”€â”€ Payment App Functions â”€â”€â”€ */
function openJazzCashApp(){
  playSound('click');
  const phoneNumber = '03266916283';
  const amount = document.getElementById('depositAmount').value;
  
  // Try multiple deep link formats
  const deepLinks = [
    `jazzcash://sendmoney?to=${phoneNumber}&amount=${amount}`,
    `jazzcash://transfer?phone=${phoneNumber}&amount=${amount}`,
    `jazzcash://payment?number=${phoneNumber}&amount=${amount}`,
    `intent://sendmoney?to=${phoneNumber}&amount=${amount}#Intent;scheme=jazzcash;package=com.techlogix.mobilinkcustomer;end`
  ];
  
  // Try first deep link
  const iframe = document.createElement('iframe');
  iframe.style.display = 'none';
  iframe.src = deepLinks[0];
  document.body.appendChild(iframe);
  
  // Fallback after 1.5 seconds
  setTimeout(() => {
    document.body.removeChild(iframe);
    
    // Show manual option
    if(confirm(
      `JazzCash App Opening...\n\n` +
      `If app didn't open:\n` +
      `Number: ${phoneNumber}\n` +
      `Amount: Rs ${amount}\n\n` +
      `Copy number to clipboard?`
    )){
      copyToClipboard(phoneNumber);
      alert(`Number copied: ${phoneNumber}\n\nPlease:\n1. Open JazzCash app manually\n2. Send Rs ${amount}\n3. Return here and click Submit`);
    }
  }, 1500);
}

function openEasypaisaApp(){
  playSound('click');
  const phoneNumber = '03193433587';
  const amount = document.getElementById('depositAmount').value;
  
  // Try multiple deep link formats
  const deepLinks = [
    `easypaisa://sendmoney?to=${phoneNumber}&amount=${amount}`,
    `easypaisa://transfer?phone=${phoneNumber}&amount=${amount}`,
    `easypaisa://payment?number=${phoneNumber}&amount=${amount}`,
    `intent://sendmoney?to=${phoneNumber}&amount=${amount}#Intent;scheme=easypaisa;package=pk.com.telenor.easypaisa;end`
  ];
  
  // Try first deep link
  const iframe = document.createElement('iframe');
  iframe.style.display = 'none';
  iframe.src = deepLinks[0];
  document.body.appendChild(iframe);
  
  // Fallback after 1.5 seconds
  setTimeout(() => {
    document.body.removeChild(iframe);
    
    // Show manual option
    if(confirm(
      `Easypaisa App Opening...\n\n` +
      `If app didn't open:\n` +
      `Number: ${phoneNumber}\n` +
      `Amount: Rs ${amount}\n\n` +
      `Copy number to clipboard?`
    )){
      copyToClipboard(phoneNumber);
      alert(`Number copied: ${phoneNumber}\n\nPlease:\n1. Open Easypaisa app manually\n2. Send Rs ${amount}\n3. Return here and click Submit`);
    }
  }, 1500);
}

function copyToClipboard(text){
  if(navigator.clipboard){
    navigator.clipboard.writeText(text).then(() => {
      alert('âœ… Number copied: ' + text);
    });
  } else {
    // Fallback for older browsers
    const input = document.createElement('input');
    input.value = text;
    document.body.appendChild(input);
    input.select();
    document.execCommand('copy');
    document.body.removeChild(input);
    alert('âœ… Number copied: ' + text);
  }
}

/* â”€â”€â”€ Win-rate table â”€â”€â”€ */
const WIN_RATES = {
   1:0.02, 2:0.05, 3:0.10, 4:0.20, 5:0.40,
   6:0.60, 7:0.70, 8:0.80, 9:0.90, 10:1.00,
  11:1.10,12:1.20,13:1.30,14:1.40,15:1.50,
  16:1.60,17:1.70,18:1.80,19:1.90,20:2.00,
  21:2.20,22:2.50,23:3.00,24:4.00,
};
function getWinRate(){ return WIN_RATES[gameState.minesCount] || 0.10; }

/* â”€â”€â”€ Withdraw tab state â”€â”€â”€ */
let withdrawMethod = 'jazz';

function switchWithdrawTab(method){
  withdrawMethod = method;
  const tabJ = document.getElementById('tabJazz');
  const tabE = document.getElementById('tabEasy');
  const inp  = document.getElementById('withdrawJazz');
  if(method === 'jazz'){
    tabJ.classList.add('active-tab');
    tabJ.classList.remove('easy-active');
    tabE.classList.remove('active-tab','easy-active');
    inp.placeholder = 'JazzCash 03XXXXXXXXX';
  } else {
    tabE.classList.add('active-tab','easy-active');
    tabJ.classList.remove('active-tab');
    inp.placeholder = 'Easypaisa 03XXXXXXXXX';
  }
  inp.value = '';
}

/* â”€â”€â”€ Cooldowns â”€â”€â”€ */
function checkDepositCooldown(){
  const last = localStorage.getItem(`lastDeposit_${gameState.userPhone}`);
  if(last){ const e=Date.now()-parseInt(last), c=5*60*1000; if(e<c) return {allowed:false, remaining:Math.ceil((c-e)/60000)}; }
  return {allowed:true};
}
function checkWithdrawCooldown(){
  const last = localStorage.getItem(`lastWithdraw_${gameState.userPhone}`);
  if(last){ const e=Date.now()-parseInt(last), c=2*60*60*1000; if(e<c) return {allowed:false, remaining:Math.ceil((c-e)/60000)}; }
  return {allowed:true};
}

/* â”€â”€â”€ Firebase helpers â”€â”€â”€ */
async function saveUserData(phone,data){
  await fbReady();
  try{
    await window.dbSet(window.dbRef(window.db,`users/${phone}`),{...data,lastUpdated:window.dbServerTimestamp()});
    return true;
  }catch(e){ console.error(e); return false; }
}
async function getUserData(phone){
  await fbReady();
  try{
    const snap = await window.dbGet(window.dbRef(window.db,`users/${phone}`));
    return snap.exists() ? snap.val() : null;
  }catch(e){ console.error(e); return null; }
}
async function updateUserBalance(phone,bal){
  await fbReady();
  try{
    await window.dbUpdate(window.dbRef(window.db,`users/${phone}`),{balance:bal,lastUpdated:window.dbServerTimestamp()});
    return true;
  }catch(e){ console.error(e); return false; }
}
function listenToUserData(phone){
  window.dbOnValue(window.dbRef(window.db,`users/${phone}`), snap=>{
    if(!snap.exists()) return;
    const d = snap.val();
    
    // Check if banned
    if(d.banned){
      showKickedScreen();
      return;
    }
    
    // Check if kicked (device changed or logged out)
    const currentDeviceId = getDeviceFingerprint();
    if(!d.isOnline || (d.deviceId && d.deviceId !== currentDeviceId)){
      showKickedScreen();
      return;
    }
    
    gameState.balance = d.balance||0;
    updateDisplay();
  });
  
  // Listen to deposit requests
  window.dbOnValue(window.dbRef(window.db,'depositRequests'), snap=>{
    updateDepositButtonState(phone, snap);
  });
  
  // Listen to withdraw requests
  window.dbOnValue(window.dbRef(window.db,'withdrawRequests'), snap=>{
    updateWithdrawButtonState(phone, snap);
  });
}

function updateDepositButtonState(phone, snapshot){
  const btn = document.getElementById('depositBtn');
  if(!btn) return;
  
  let hasPending = false;
  let pendingRequest = null;
  if(snapshot && snapshot.exists()){
    snapshot.forEach(child => {
      const req = child.val();
      if(req.phone === phone && req.status === 'pending'){
        hasPending = true;
        pendingRequest = req;
      }
    });
  }
  
  if(hasPending){
    btn.textContent = 'â³ PENDING';
    btn.disabled = false; // Make clickable
    btn.style.opacity = '0.8';
    btn.style.cursor = 'pointer';
    btn.onclick = () => showPendingDepositStatus(pendingRequest);
  } else {
    btn.textContent = 'DEPOSIT';
    btn.disabled = false;
    btn.style.opacity = '1';
    btn.style.cursor = 'pointer';
    btn.onclick = openDepositModal;
  }
}

function updateWithdrawButtonState(phone, snapshot){
  const btn = document.getElementById('withdrawBtn');
  if(!btn) return;
  
  let hasPending = false;
  let pendingRequest = null;
  if(snapshot && snapshot.exists()){
    snapshot.forEach(child => {
      const req = child.val();
      if(req.phone === phone && req.status === 'pending'){
        hasPending = true;
        pendingRequest = req;
      }
    });
  }
  
  if(hasPending){
    btn.textContent = 'â³ PENDING';
    btn.disabled = false; // Make clickable
    btn.style.opacity = '0.8';
    btn.style.cursor = 'pointer';
    btn.onclick = () => showPendingWithdrawStatus(pendingRequest);
  } else {
    btn.textContent = 'WITHDRAW';
    btn.disabled = false;
    btn.style.opacity = '1';
    btn.style.cursor = 'pointer';
    btn.onclick = openWithdrawModal;
  }
}

function showPendingDepositStatus(request){
  playSound('click');
  if(!request){
    // Fallback if no request data
    document.getElementById('pendingDepAmount').textContent = 'Rs --';
    document.getElementById('pendingDepDate').textContent = 'Submitted: --';
  } else {
    const date = request.timestamp ? new Date(request.timestamp).toLocaleString() : 'N/A';
    document.getElementById('pendingDepAmount').textContent = 'Rs ' + request.amount;
    document.getElementById('pendingDepDate').textContent = 'Submitted: ' + date;
  }
  document.getElementById('pendingDepositModal').classList.add('active');
}

function showPendingWithdrawStatus(request){
  playSound('click');
  if(!request){
    // Fallback if no request data
    document.getElementById('pendingWdAmount').textContent = 'Rs --';
    document.getElementById('pendingWdMethod').textContent = '--';
    document.getElementById('pendingWdNumber').textContent = '--';
    document.getElementById('pendingWdDate').textContent = 'Submitted: --';
  } else {
    const date = request.timestamp ? new Date(request.timestamp).toLocaleString() : 'N/A';
    const method = request.withdrawMethod === 'jazz' ? 'JazzCash' : 'Easypaisa';
    document.getElementById('pendingWdAmount').textContent = 'Rs ' + request.amount;
    document.getElementById('pendingWdMethod').textContent = method;
    document.getElementById('pendingWdNumber').textContent = request.jazzCash || '--';
    document.getElementById('pendingWdDate').textContent = 'Submitted: ' + date;
  }
  document.getElementById('pendingWithdrawModal').classList.add('active');
}
async function submitDepositRequest(uid,name,phone,amount){
  await fbReady();
  try{
    const r = window.dbPush(window.dbRef(window.db,'depositRequests'));
    await window.dbSet(r,{id:r.key,userId:uid,name,phone,amount,status:'pending',timestamp:window.dbServerTimestamp()});
    return true;
  }catch(e){ console.error(e); return false; }
}
async function submitWithdrawRequest(uid,name,phone,jazz,amount,method){
  await fbReady();
  try{
    const r = window.dbPush(window.dbRef(window.db,'withdrawRequests'));
    await window.dbSet(r,{
      id:r.key, userId:uid, name, phone,
      jazzCash: jazz,
      withdrawMethod: method,
      amount, status:'pending',
      timestamp:window.dbServerTimestamp()
    });
    return true;
  }catch(e){ console.error(e); return false; }
}

/* â”€â”€â”€ Login â”€â”€â”€ */
async function handleLogin(){
  await fbReady();
  const name  = document.getElementById('loginName').value.trim();
  const phone = document.getElementById('loginPhone').value.trim();
  if(!name){ showMessage('loginMsg','Please enter your name!','error'); return; }
  if(!/^03[0-9]{9}$/.test(phone)){ showMessage('loginMsg','Invalid phone! Must be 03XXXXXXXXX','error'); return; }
  showMessage('loginMsg','Logging inâ€¦','success');

  const deviceId = getDeviceFingerprint();
  const namePairKey = `${name}_${phone}`;

  try {
    // FIRST CHECK: Banned phones list (extra security layer)
    const bannedPhoneSnap = await window.dbGet(window.dbRef(window.db, `bannedPhones/${phone}`));
    if(bannedPhoneSnap.exists()){
      showMessage('loginMsg','','error');
      setTimeout(() => showKickedScreen(), 500);
      return;
    }
    
    // SECOND CHECK: Phone number ban check in users
    const phoneCheckSnap = await window.dbGet(window.dbRef(window.db, `users/${phone}`));
    if(phoneCheckSnap.exists()){
      const phoneUserData = phoneCheckSnap.val();
      if(phoneUserData.banned){
        showMessage('loginMsg','','error');
        setTimeout(() => showKickedScreen(), 500);
        return;
      }
    }
    
    // Check 1: Name-Phone pair lock
    const pairSnap = await window.dbGet(window.dbRef(window.db, `namePhonePairs/${namePairKey}`));
    if(pairSnap.exists()){
      const pairData = pairSnap.val();
      if(pairData.banned){
        showMessage('loginMsg','','error');
        setTimeout(() => showKickedScreen(), 500);
        return;
      }
      if(pairData.deviceId !== deviceId){
        showMessage('loginMsg','âŒ This name-phone combination is locked to another device!','error');
        return;
      }
    }
    
    // Check 2: Device limit (max 2 users per device)
    const deviceTrackSnap = await window.dbGet(window.dbRef(window.db, `deviceTracking/${deviceId}`));
    if(deviceTrackSnap.exists()){
      const deviceData = deviceTrackSnap.val();
      const usersOnDevice = deviceData.users || {};
      const userCount = Object.keys(usersOnDevice).length;
      
      // If user not already on this device and device has 2 users
      if(!usersOnDevice[phone] && userCount >= 2){
        showMessage('loginMsg','âŒ Maximum 2 accounts per device!','error');
        return;
      }
      
      // Check if phone exists with different name
      if(usersOnDevice[phone] && usersOnDevice[phone].name !== name){
        showMessage('loginMsg','âŒ Phone number registered with different name!','error');
        return;
      }
    }
    
    // Check 3: User already logged in or banned
    const userSnap = await window.dbGet(window.dbRef(window.db, `users/${phone}`));
    if(userSnap.exists()){
      const userData = userSnap.val();
      
      // Check if banned
      if(userData.banned){
        showKickedScreen();
        return;
      }
      
      // Check if logged in elsewhere
      if(userData.isOnline && userData.deviceId && userData.deviceId !== deviceId){
        showMessage('loginMsg','ÛŒÛ Ø§Ú©Ø§Ø¤Ù†Ù¹ Ù¾ÛÙ„Û’ Ø³Û’ Ú©Ø³ÛŒ Ø§ÙˆØ± ÚˆÛŒÙˆØ§Ø¦Ø³ Ù¾Ø± Ù„Ø§Ú¯ Ø§Ù† ÛÛ’!','error');
        return;
      }
      
      // Check name mismatch
      if(userData.name !== name){
        showMessage('loginMsg','âŒ Name does not match registered name!','error');
        return;
      }
    }
    
    // All checks passed - proceed with login
    const now = Date.now();
    const updates = {};
    
    let userData = userSnap.exists() ? userSnap.val() : null;
    
    // Update or create user data
    if(!userData){
      updates[`users/${phone}`] = {
        name, phone, balance:0, totalDeposit:0, totalWithdraw:0,
        createdAt:now, deviceId, isOnline:true, lastLogin:now
      };
    } else {
      updates[`users/${phone}/deviceId`] = deviceId;
      updates[`users/${phone}/isOnline`] = true;
      updates[`users/${phone}/lastLogin`] = now;
      updates[`users/${phone}/name`] = name;
    }
    
    // Lock name-phone pair to this device
    updates[`namePhonePairs/${namePairKey}/deviceId`] = deviceId;
    updates[`namePhonePairs/${namePairKey}/registeredAt`] = now;
    updates[`namePhonePairs/${namePairKey}/locked`] = true;
    
    // Track device usage
    updates[`deviceTracking/${deviceId}/users/${phone}/name`] = name;
    updates[`deviceTracking/${deviceId}/users/${phone}/lastLogin`] = now;
    
    await window.dbUpdate(window.dbRef(window.db), updates);
    
    // Continue with normal login flow
    gameState.userId = phone;
    gameState.userName = name;
    gameState.userPhone = phone;
    gameState.balance = userData ? (userData.balance || 0) : 0;
    
    document.getElementById('displayName').textContent = gameState.userName;
    document.getElementById('displayPhone').textContent = phone;
    document.getElementById('loginScreen').classList.add('hidden');
    document.getElementById('gameScreen').classList.remove('hidden');
    
    listenToUserData(phone);
    initializeGrid();
    updateDisplay();
    
    if(!userData){
      showMessage('loginMsg','âœ… Account created!','success');
    }
    
  } catch(e){
    console.error(e);
    showMessage('loginMsg','âŒ Login failed: ' + e.message,'error');
  }
}

async function handleLogout(){
  if(confirm('Are you sure you want to logout?')){
    try{ 
      await fbReady(); 
      await window.dbUpdate(window.dbRef(window.db,`users/${gameState.userPhone}`),{isOnline:false,deviceId:null}); 
    }catch(e){}
    location.reload();
  }
}
function showKickedScreen(){ document.getElementById('kickedOverlay').classList.add('active'); }

/* â”€â”€â”€ Deposit â”€â”€â”€ */
async function submitDeposit(){
  const amount = parseInt(document.getElementById('depositAmount').value);
  if(!amount||amount<500){ alert('Minimum deposit Rs 500!'); return; }
  const cd = checkDepositCooldown();
  if(!cd.allowed){ alert(`â³ Wait ${cd.remaining} more minutes.`); return; }
  if(await submitDepositRequest(gameState.userId,gameState.userName,gameState.userPhone,amount)){
    localStorage.setItem(`lastDeposit_${gameState.userPhone}`,Date.now().toString());
    alert('âœ… Deposit request submitted! Admin will approve soon.');
    closeModal('depositModal');
    document.getElementById('depositAmount').value='';
  } else alert('âŒ Request failed!');
}

/* â”€â”€â”€ Withdraw â”€â”€â”€ */
async function submitWithdraw(){
  const number = document.getElementById('withdrawJazz').value.trim();
  const amount = parseInt(document.getElementById('withdrawAmount').value);
  if(!/^03[0-9]{9}$/.test(number)){
    alert(withdrawMethod==='jazz' ? 'Invalid JazzCash number!' : 'Invalid Easypaisa number!');
    return;
  }
  if(!amount||amount<1000)        { alert('Minimum withdraw Rs 1000!'); return; }
  if(amount>gameState.balance)    { alert('Insufficient balance!'); return; }
  const cd = checkWithdrawCooldown();
  if(!cd.allowed){ const h=Math.floor(cd.remaining/60), m=cd.remaining%60; alert(`â³ Wait ${h}h ${m}m`); return; }

  if(await submitWithdrawRequest(gameState.userId,gameState.userName,gameState.userPhone,number,amount,withdrawMethod)){
    localStorage.setItem(`lastWithdraw_${gameState.userPhone}`,Date.now().toString());
    alert('âœ… Withdraw request submitted! Admin will process soon.');
    closeModal('withdrawModal');
    document.getElementById('withdrawJazz').value='';
    document.getElementById('withdrawAmount').value='';
  } else alert('âŒ Request failed!');
}

/* â”€â”€â”€ Grid & Tile logic â”€â”€â”€ */
function initializeGrid(){
  const grid = document.getElementById('gameGrid');
  grid.innerHTML='';
  for(let i=0;i<25;i++){
    const t = document.createElement('div');
    t.className='tile';
    t.onclick = ()=> clickTile(i);
    grid.appendChild(t);
  }
}

function clickTile(index){
  if(gameState.revealedTiles.includes(index)) return;
  if(!gameState.gameActive){
    if(gameState.currentBet===0){ 
      playSound('error');
      showMessage('gameMsg','Set bet first!','error'); 
      return; 
    }
    startGame();
  }
  gameState.tilesClicked = true;
  gameState.revealedTiles.push(index);
  const tiles = document.querySelectorAll('.tile');

  if(gameState.minePositions.includes(index)){
    playSound('mine');
    tiles[index].textContent = 'ğŸ’£';
    tiles[index].classList.add('revealed','mine','mine-hit');
    gameOver(false);
  } else {
    playSound('success');
    tiles[index].textContent = 'ğŸ’';
    tiles[index].classList.add('revealed','safe');
    gameState.currentWin += Math.floor(gameState.currentBet * getWinRate());
    updateDisplay();
    document.getElementById('cashoutBtn').disabled = false;
  }
}

function startGame(){
  playSound('click');
  gameState.gameActive    = true;
  gameState.minePositions = [];
  gameState.revealedTiles = [];
  gameState.currentWin    = 0;
  while(gameState.minePositions.length < gameState.minesCount){
    const p = Math.floor(Math.random()*25);
    if(!gameState.minePositions.includes(p)) gameState.minePositions.push(p);
  }
  updateDisplay();
}

async function cashout(){
  if(!gameState.gameActive || gameState.currentWin===0) return;
  playSound('win');
  const total = gameState.currentBet + gameState.currentWin;
  gameState.balance += total;
  await updateUserBalance(gameState.userPhone, gameState.balance);
  gameState.currentBet=0; gameState.currentWin=0; gameState.gameActive=false;
  gameState.betSet=false; gameState.tilesClicked=false;
  document.getElementById('cashoutBtn').disabled=true;
  updateDisplay(); revealAllTiles();
  showMessage('gameMsg',`Cashed out Rs ${total}! ğŸ‰`,'success');
}

function gameOver(won){
  if(!won) playSound('error');
  gameState.gameActive=false; gameState.currentBet=0; gameState.currentWin=0;
  gameState.betSet=false; gameState.tilesClicked=false;
  document.getElementById('cashoutBtn').disabled=true;
  updateDisplay(); revealAllTiles();
  if(!won) showMessage('gameMsg','Game Over! ğŸ’”','error');
}

function revealAllTiles(){
  document.querySelectorAll('.tile').forEach((t,i)=>{
    if(!t.classList.contains('revealed')){
      t.classList.add('revealed');
      if(gameState.minePositions.includes(i)){
        t.textContent='ğŸ’£'; t.classList.add('mine');
      } else {
        t.textContent='ğŸ’'; t.classList.add('safe');
      }
    }
  });
}

async function resetGame(){
  if(gameState.betSet && gameState.currentBet>0){
    const ret = gameState.currentBet + gameState.currentWin;
    gameState.balance += ret;
    await updateUserBalance(gameState.userPhone, gameState.balance);
    showMessage('gameMsg',
      gameState.tilesClicked
        ? `Rs ${gameState.currentBet} (bet) + Rs ${gameState.currentWin} (win) ÙˆØ§Ù¾Ø³ ÛÙˆ Ú¯Ø¦Û’!`
        : `Rs ${gameState.currentBet} ÙˆØ§Ù¾Ø³ ÛÙˆ Ú¯ÛŒØ§!`,
      'success');
  }
  gameState.gameActive=false; gameState.currentWin=0; gameState.currentBet=0;
  gameState.minePositions=[]; gameState.revealedTiles=[];
  gameState.betSet=false; gameState.tilesClicked=false;
  document.getElementById('cashoutBtn').disabled=true;
  initializeGrid(); updateDisplay();
}

function updateDisplay(){
  document.getElementById('balance').textContent      = gameState.balance;
  document.getElementById('win').textContent          = gameState.currentWin;
  document.getElementById('betDisplay').textContent   = gameState.currentBet;
  document.getElementById('minesDisplay').textContent = gameState.minesCount;
}

/* â”€â”€â”€ Bet / Mines modals â”€â”€â”€ */
function openBetModal(){
  playSound('click');
  if(gameState.gameActive){ 
    playSound('error');
    alert('Cannot change bet during active game!'); 
    return; 
  }
  document.getElementById('betModal').classList.add('active');
}
async function setBet(){
  const a = parseInt(document.getElementById('betInput').value);
  if(!a||a<100||a>10000){ 
    playSound('error');
    alert('Bet must be Rs 100â€“10,000'); 
    return; 
  }
  if(a>gameState.balance){ 
    playSound('error');
    alert('Insufficient balance!'); 
    return; 
  }
  playSound('success');
  gameState.balance-=a; gameState.currentBet=a; gameState.betSet=true; gameState.tilesClicked=false;
  await updateUserBalance(gameState.userPhone,gameState.balance);
  updateDisplay(); closeModal('betModal');
  showMessage('gameMsg','Bet set! Start playing!','success');
}
function openMinesModal(){
  playSound('click');
  if(gameState.gameActive){ 
    playSound('error');
    alert('Cannot change mines during game!'); 
    return; 
  }
  document.getElementById('minesModal').classList.add('active');
}
function setMines(){
  const c = parseInt(document.getElementById('minesInput').value);
  if(!c||c<1||c>24){ 
    playSound('error');
    alert('Mines must be 1â€“24'); 
    return; 
  }
  playSound('click');
  gameState.minesCount=c; updateDisplay(); closeModal('minesModal');
}

/* â”€â”€â”€ Check Deposit Amount to Enable Next Button â”€â”€â”€ */
function checkDepositAmount(){
  const amount = parseInt(document.getElementById('depositAmount').value);
  const btn = document.getElementById('depositNextBtn');
  
  if(amount && amount >= 500){
    // Enable next button
    btn.disabled = false;
    btn.style.opacity = '1';
    btn.style.cursor = 'pointer';
  } else {
    // Disable next button
    btn.disabled = true;
    btn.style.opacity = '0.5';
    btn.style.cursor = 'not-allowed';
  }
}

/* â”€â”€â”€ Show Payment Methods Step â”€â”€â”€ */
function showPaymentMethods(){
  playSound('click');
  const amount = parseInt(document.getElementById('depositAmount').value);
  
  if(!amount || amount < 500){
    playSound('error');
    alert('Please enter minimum Rs 500');
    return;
  }
  
  // Show amount on payment screen
  document.getElementById('depositAmountDisplay').textContent = amount;
  
  // Hide step 1, show step 2
  document.getElementById('depositStep1').style.display = 'none';
  document.getElementById('depositStep2').style.display = 'block';
}

/* â”€â”€â”€ Back to Amount Step â”€â”€â”€ */
function backToAmountStep(){
  playSound('click');
  document.getElementById('depositStep2').style.display = 'none';
  document.getElementById('depositStep1').style.display = 'block';
}

/* â”€â”€â”€ UI helpers â”€â”€â”€ */
function openDepositModal(){
  playSound('click');
  
  // Reset to step 1
  document.getElementById('depositStep1').style.display = 'block';
  document.getElementById('depositStep2').style.display = 'none';
  
  // Reset amount input and next button state
  document.getElementById('depositAmount').value = '';
  const nextBtn = document.getElementById('depositNextBtn');
  nextBtn.disabled = true;
  nextBtn.style.opacity = '0.5';
  
  const cd = checkDepositCooldown();
  document.getElementById('depositCooldown').style.display = cd.allowed ? 'none' : 'block';
  if(!cd.allowed) document.getElementById('depositCooldown').textContent = `â³ Wait ${cd.remaining} minutes`;
  document.getElementById('depositModal').classList.add('active');
}
function openWithdrawModal(){
  playSound('click');
  const cd = checkWithdrawCooldown();
  document.getElementById('withdrawCooldown').style.display = cd.allowed ? 'none' : 'block';
  if(!cd.allowed){
    const h=Math.floor(cd.remaining/60), m=cd.remaining%60;
    document.getElementById('withdrawCooldown').textContent = `â³ Wait ${h}h ${m}m`;
  }
  switchWithdrawTab('jazz');
  document.getElementById('withdrawModal').classList.add('active');
}
function closeModal(id){ 
  playSound('click');
  document.getElementById(id).classList.remove('active'); 
}
function showMessage(elId, text, type){
  const el = document.getElementById(elId);
  el.textContent=text; el.className='msg '+type; el.style.display='block';
  setTimeout(()=>el.style.display='none', 3000);
}
</script>

</body>
</html>